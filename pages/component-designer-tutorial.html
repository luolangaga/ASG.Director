<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç»„ä»¶ç§¯æœ¨ API æ•™ç¨‹</title>
  <style>
    :root {
      --bg: #12131a;
      --card: #1d1f2a;
      --card-2: #25283a;
      --line: #343850;
      --text: #f4f6ff;
      --muted: #b8bfd8;
      --accent: #ffd86b;
      --ok: #22c55e;
      --warn: #f59e0b;
    }

    body {
      margin: 0;
      background: radial-gradient(circle at top right, #1b2340, #12131a 42%);
      color: var(--text);
      font-family: "Outfit", "Microsoft YaHei", "Segoe UI", sans-serif;
      line-height: 1.62;
    }

    .wrap {
      max-width: 1160px;
      margin: 0 auto;
      padding: 20px 16px 38px;
    }

    h1,
    h2,
    h3 {
      margin: 0 0 10px;
    }

    h1 {
      font-size: 30px;
      letter-spacing: 0.4px;
    }

    h2 {
      font-size: 20px;
      color: #ffe79d;
      margin-top: 18px;
    }

    h3 {
      font-size: 16px;
      color: #f9dc90;
      margin-top: 12px;
    }

    p,
    li {
      font-size: 14px;
      color: var(--text);
    }

    ul,
    ol {
      margin: 8px 0 0 20px;
      padding: 0;
    }

    code {
      background: #2a2f46;
      border: 1px solid #3f4668;
      border-radius: 6px;
      padding: 1px 6px;
      color: #fff;
      font-size: 13px;
    }

    pre {
      margin: 8px 0 0;
      border-radius: 10px;
      border: 1px solid var(--line);
      background: #171927;
      color: #eaf1ff;
      padding: 12px;
      overflow: auto;
      font-size: 12px;
      line-height: 1.45;
    }

    .hero {
      border: 1px solid #3d4363;
      border-radius: 14px;
      padding: 16px 18px;
      background: linear-gradient(150deg, #2a2d40 0%, #1d2031 100%);
      box-shadow: 0 8px 28px rgba(0, 0, 0, 0.35);
    }

    .muted {
      color: var(--muted);
      font-size: 13px;
    }

    .row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-top: 12px;
    }

    .card {
      border: 1px solid var(--line);
      border-radius: 12px;
      background: var(--card);
      padding: 12px 14px;
    }

    .tip {
      border: 1px solid #4b4f6d;
      border-radius: 10px;
      padding: 10px 12px;
      margin-top: 10px;
      font-size: 13px;
      color: #e7ecff;
      background: rgba(255, 255, 255, 0.04);
    }

    .tip.ok {
      border-color: rgba(34, 197, 94, 0.5);
      background: rgba(34, 197, 94, 0.14);
      color: #c9f7db;
    }

    .tip.warn {
      border-color: rgba(245, 158, 11, 0.55);
      background: rgba(245, 158, 11, 0.14);
      color: #fde9b2;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 8px;
      font-size: 13px;
    }

    th,
    td {
      border: 1px solid var(--line);
      padding: 8px;
      text-align: left;
      vertical-align: top;
    }

    th {
      background: var(--card-2);
      color: #f6f7ff;
    }

    .section {
      margin-top: 12px;
    }

    @media (max-width: 980px) {
      .row {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>

<body>
  <div class="wrap">
    <section class="hero">
      <h1>ç»„ä»¶è®¾è®¡å™¨ Â· ç§¯æœ¨ API å®Œæ•´æ•™ç¨‹</h1>
      <p>æœ¬é¡µè¦†ç›–ä½ ç°åœ¨è¿™å¥—â€œç»„ä»¶ç§¯æœ¨æ¨¡å¼â€çš„å…¨éƒ¨ APIï¼šè§¦å‘å™¨ã€åŠ¨ä½œå‚æ•°ã€æ¨¡æ¿å˜é‡ã€Patch å­—æ®µï¼Œä»¥åŠå¯ç›´æ¥ç…§æŠ„çš„å®Œæ•´ç¤ºä¾‹ã€‚</p>
      <p class="muted">æ‰“å¼€æ–¹å¼ï¼šç»„ä»¶è®¾è®¡å™¨é¡¶éƒ¨ <code>ğŸ“˜ APIæ•™ç¨‹</code> æŒ‰é’®ã€‚</p>
      <div class="tip ok">ç›®æ ‡èƒ½åŠ›ï¼šé€šè¿‡ç§¯æœ¨ç›´æ¥åšâ€œäº‹ä»¶é©±åŠ¨ UIâ€ï¼ŒåŒ…æ‹¬è°ƒç”¨ APIã€è§¦å‘äº‹ä»¶ã€ä¿®æ”¹ç»„ä»¶å±æ€§ã€æ‰§è¡Œè‡ªå®šä¹‰å‘½ä»¤ã€‚</div>
    </section>

    <div class="row">
      <section class="card">
        <h2>1. 30 ç§’ä¸Šæ‰‹</h2>
        <ol>
          <li>è¿›å…¥ <code>ç»„ä»¶è®¾è®¡å™¨</code>ï¼Œæ–°å»ºç»„ä»¶å¹¶åˆ†é…åˆ°æŸä¸ªå‰å°çª—å£ã€‚</li>
          <li>åˆ‡åˆ° <code>ğŸ§© ç§¯æœ¨</code> é¡µç­¾ã€‚</li>
          <li>æ–°å»ºè§„åˆ™ï¼šé€‰è§¦å‘å™¨ -> æ·»åŠ åŠ¨ä½œ -> å¡«å‚æ•°ã€‚</li>
          <li>ç‚¹å‡»å³ä¸Šè§’ <code>ä¿å­˜å…¨éƒ¨</code>ï¼Œæ‰“å¼€å‰å°çª—å£éªŒè¯ã€‚</li>
        </ol>
        <div class="tip">ç¼–è¾‘æ¨¡å¼æŒ‰ <code>F2</code> åˆ‡æ¢ï¼›è‡ªå®šä¹‰çª—å£æœ‰è¾¹ç¼˜æ¡†å’Œè¿›åœºåŠ¨ç”»ï¼Œå¯ç›´æ¥é¢„è§ˆè¡Œä¸ºã€‚</div>
      </section>

      <section class="card">
        <h2>2. æ•°æ®æ¨¡å‹</h2>
        <p class="muted">æ¯ä¸ªç»„ä»¶åŒ…å« <code>behavior.rules</code>ã€‚ç»“æ„å¦‚ä¸‹ï¼š</p>
        <pre><code>{
  "behavior": {
    "version": 1,
    "rules": [
      {
        "id": "rule_xxx",
        "name": "ç‚¹å‡»åæ”¹å­—",
        "enabled": true,
        "triggerType": "component:click",
        "triggerEventName": "",
        "actions": [
          {
            "id": "act_xxx",
            "type": "SET_COMPONENT_PROPERTY",
            "enabled": true,
            "delay": "",
            "params": { "componentId": "", "patchJson": "{\"text\":\"Hello\"}" }
          }
        ]
      }
    ]
  }
}</code></pre>
      </section>
    </div>

    <section class="card section">
      <h2>3. è§¦å‘å™¨ APIï¼ˆTriggerTypeï¼‰</h2>
      <table>
        <thead>
          <tr>
            <th>è§¦å‘å™¨</th>
            <th>å«ä¹‰</th>
            <th>å…¸å‹ eventData å­—æ®µ</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><code>component:init</code></td>
            <td>ç»„ä»¶åˆšæ¸²æŸ“å®Œæˆæ—¶è§¦å‘ä¸€æ¬¡</td>
            <td><code>componentId</code></td>
          </tr>
          <tr>
            <td><code>component:click</code></td>
            <td>é¼ æ ‡ç‚¹å‡»ç»„ä»¶</td>
            <td><code>x</code> <code>y</code> <code>button</code></td>
          </tr>
          <tr>
            <td><code>component:dblclick</code></td>
            <td>é¼ æ ‡åŒå‡»ç»„ä»¶</td>
            <td><code>x</code> <code>y</code></td>
          </tr>
          <tr>
            <td><code>component:mouseenter</code></td>
            <td>é¼ æ ‡è¿›å…¥ç»„ä»¶</td>
            <td><code>x</code> <code>y</code></td>
          </tr>
          <tr>
            <td><code>component:mouseleave</code></td>
            <td>é¼ æ ‡ç¦»å¼€ç»„ä»¶</td>
            <td><code>x</code> <code>y</code></td>
          </tr>
          <tr>
            <td><code>custom:event</code></td>
            <td>ç”±åŠ¨ä½œ <code>EMIT_CUSTOM_EVENT</code> æˆ– API å›è°ƒç»§ç»­è§¦å‘</td>
            <td><code>eventName</code> + ä½ è‡ªå®šä¹‰çš„ payload</td>
          </tr>
          <tr>
            <td><code>bp:hunter-selected</code></td>
            <td>BP ç›‘ç®¡è€…ç¡®è®¤</td>
            <td><code>hunter</code> <code>character</code></td>
          </tr>
          <tr>
            <td><code>bp:survivor-selected</code></td>
            <td>BP ä»»æ„æ±‚ç”Ÿè€…ç¡®è®¤</td>
            <td><code>survivor</code> <code>selectedCount</code></td>
          </tr>
          <tr>
            <td><code>localbp:state-updated</code></td>
            <td>æœ¬åœ° BP çŠ¶æ€å˜åŒ–</td>
            <td><code>state</code> <code>mapName</code> <code>teamA/teamB</code></td>
          </tr>
          <tr>
            <td><code>localbp:score-updated</code></td>
            <td>æ¯”åˆ†å˜åŒ–</td>
            <td><code>scoreData</code> <code>matchScoreA/B</code></td>
          </tr>
        </tbody>
      </table>
    </section>

    <section class="card section">
      <h2>4. åŠ¨ä½œ APIï¼ˆActionTypeï¼‰</h2>
      <table>
        <thead>
          <tr>
            <th>åŠ¨ä½œ</th>
            <th>æ ¸å¿ƒå‚æ•°</th>
            <th>è¯´æ˜</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><code>DELAY</code></td>
            <td><code>duration</code></td>
            <td>ç­‰å¾…æ—¶é•¿ã€‚æ”¯æŒ <code>500ms</code> / <code>1.2s</code> / <code>01:30</code>ã€‚</td>
          </tr>
          <tr>
            <td><code>SET_COMPONENT_PROPERTY</code></td>
            <td><code>componentId</code> <code>patchJson</code></td>
            <td>æ”¹ç»„ä»¶å¯è§æ€§ã€ä½ç½®ã€å¤§å°ã€æ–‡æœ¬ã€HTMLã€æ ·å¼ç­‰ï¼ˆè§ä¸‹ä¸€èŠ‚ Patch APIï¼‰ã€‚</td>
          </tr>
          <tr>
            <td><code>CALL_CUSTOM_API</code></td>
            <td><code>url</code> <code>method</code> <code>headersJson</code> <code>bodyJson</code> <code>timeoutMs</code> <code>saveAs</code> <code>resultEventName</code></td>
            <td>å‘ HTTP è¯·æ±‚ã€‚ç»“æœå†™å…¥ <code>{{runtime.å˜é‡å}}</code>ï¼Œå¯é€‰æ‹©ç»§ç»­è§¦å‘äº‹ä»¶ã€‚</td>
          </tr>
          <tr>
            <td><code>EMIT_CUSTOM_EVENT</code></td>
            <td><code>eventName</code> <code>payloadJson</code></td>
            <td>å¹¿æ’­åˆ°ç§¯æœ¨è¿è¡Œæ—¶ï¼Œç”¨äºåŠ¨ä½œé“¾æ‹†åˆ†å’Œå¤ç”¨ã€‚</td>
          </tr>
          <tr>
            <td><code>EXECUTE_COMMAND</code></td>
            <td><code>command</code> <code>argsJson</code></td>
            <td>å‘é€å‘½ä»¤é£æ ¼äº‹ä»¶ï¼ˆäº‹ä»¶åä¸º <code>command:xxx</code>ï¼‰ã€‚</td>
          </tr>
        </tbody>
      </table>
    </section>

    <section class="card section">
      <h2>5. Patch APIï¼ˆSET_COMPONENT_PROPERTY çš„ patchJsonï¼‰</h2>
      <p class="muted">å¸¸è§å­—æ®µå¦‚ä¸‹ï¼Œå…¨éƒ¨å¯æ··åˆä½¿ç”¨ï¼š</p>
      <table>
        <thead>
          <tr>
            <th>å­—æ®µ</th>
            <th>ç±»å‹</th>
            <th>ä½œç”¨</th>
          </tr>
        </thead>
        <tbody>
          <tr><td><code>visible</code></td><td>boolean</td><td>æ˜¾ç¤º/éšè—ç»„ä»¶</td></tr>
          <tr><td><code>x</code> <code>y</code></td><td>number/string</td><td>ç»å¯¹å®šä½ï¼ˆæ”¯æŒæ•°å­—æˆ– CSS é•¿åº¦ï¼‰</td></tr>
          <tr><td><code>width</code> <code>height</code></td><td>number/string</td><td>å®½é«˜</td></tr>
          <tr><td><code>zIndex</code></td><td>number/string</td><td>å±‚çº§</td></tr>
          <tr><td><code>opacity</code></td><td>number/string</td><td>é€æ˜åº¦</td></tr>
          <tr><td><code>style</code></td><td>object</td><td>åˆå¹¶åˆ°å®¹å™¨ style</td></tr>
          <tr><td><code>contentStyle</code></td><td>object</td><td>åˆå¹¶åˆ°å†…å®¹å±‚ style</td></tr>
          <tr><td><code>attrs</code></td><td>object</td><td>è®¾ç½®/ç§»é™¤ HTML å±æ€§</td></tr>
          <tr><td><code>classAdd</code> <code>classRemove</code></td><td>string/array</td><td>å¢åˆ  class</td></tr>
          <tr><td><code>text</code></td><td>string</td><td>å†™å…¥çº¯æ–‡æœ¬ï¼ˆè¦†ç›–å†…å®¹ï¼‰</td></tr>
          <tr><td><code>html</code></td><td>string</td><td>å†™å…¥ HTML</td></tr>
          <tr><td><code>imageSrc</code></td><td>string</td><td>æ›¿æ¢å†…éƒ¨ img çš„ src</td></tr>
          <tr><td><code>propertyPath</code> + <code>value</code></td><td>string + any</td><td>æŒ‰è·¯å¾„å†™å…¥å±æ€§ï¼Œå¦‚ <code>style.transform</code>ã€‚</td></tr>
        </tbody>
      </table>

      <h3>Patch ç¤ºä¾‹</h3>
      <pre><code>{
  "visible": true,
  "x": 120,
  "y": 40,
  "width": 420,
  "style": { "border": "2px solid #ffd700", "background": "rgba(0,0,0,.38)" },
  "text": "å½“å‰ç›‘ç®¡è€…ï¼š{{bpHunter}}"
}</code></pre>
    </section>

    <section class="card section">
      <h2>6. æ¨¡æ¿å˜é‡ API</h2>
      <p>æ‰€æœ‰å­—ç¬¦ä¸²å‚æ•°å‡æ”¯æŒ <code>{{å˜é‡}}</code> æ¨¡æ¿è¯­æ³•ï¼ŒåŠ¨ä½œæ‰§è¡Œæ—¶æ›¿æ¢ã€‚</p>

      <h3>6.1 å¸¸ç”¨ BP / æ¯”èµ›å˜é‡</h3>
      <p><code>{{bpHunter}}</code> <code>{{bpSurvivors.0}}</code> <code>{{bpSurvivorsText}}</code> <code>{{bpBannedHuntersText}}</code> <code>{{matchTitle}}</code> <code>{{matchScore}}</code> <code>{{roomId}}</code></p>

      <h3>6.2 äº‹ä»¶å˜é‡</h3>
      <p>é€šè¿‡ <code>{{eventData.xxx}}</code> è¯»å–å½“å‰è§¦å‘äº‹ä»¶å­—æ®µï¼Œæ¯”å¦‚ <code>{{eventData.mapName}}</code>ã€‚</p>

      <h3>6.3 API ç»“æœå˜é‡ï¼ˆCALL_CUSTOM_APIï¼‰</h3>
      <p>å½“ <code>saveAs = playerApi</code> æ—¶ï¼Œå¯è¯»å–ï¼š</p>
      <p><code>{{runtime.playerApi.ok}}</code> <code>{{runtime.playerApi.status}}</code> <code>{{runtime.playerApi.body.name}}</code></p>
    </section>

    <section class="card section">
      <h2>7. å¯ç›´æ¥ç”¨çš„å®Œæ•´å®ä¾‹</h2>

      <h3>å®ä¾‹ Aï¼šç‚¹å‡»ç»„ä»¶åˆ‡æ¢æ–‡æœ¬</h3>
      <pre><code>è§¦å‘å™¨: component:click
åŠ¨ä½œ1: SET_COMPONENT_PROPERTY
componentId: ""
patchJson:
{
  "text": "å·²ç‚¹å‡» {{eventData.componentId}}",
  "style": { "color": "#ffd86b" }
}</code></pre>

      <h3>å®ä¾‹ Bï¼šåˆå§‹åŒ–æ—¶æ‹‰æ¥å£å¹¶æ¸²æŸ“åå­—</h3>
      <pre><code>è§¦å‘å™¨: component:init
åŠ¨ä½œ1: CALL_CUSTOM_API
url: https://api.example.com/player/current
method: GET
headersJson: {}
bodyJson: {}
timeoutMs: 8000
saveAs: playerApi
resultEventName: player:loaded

è§¦å‘å™¨: custom:event
triggerEventName: player:loaded
åŠ¨ä½œ1: SET_COMPONENT_PROPERTY
patchJson:
{
  "text": "é€‰æ‰‹ï¼š{{runtime.playerApi.body.name}}",
  "visible": true
}</code></pre>

      <h3>å®ä¾‹ Cï¼šBP é€‰äººåè‡ªåŠ¨é«˜äº®ç»„ä»¶</h3>
      <pre><code>è§¦å‘å™¨: bp:survivor-selected
åŠ¨ä½œ1: SET_COMPONENT_PROPERTY
patchJson:
{
  "text": "å·²é€‰æ±‚ç”Ÿè€…ï¼š{{eventData.survivor}}",
  "style": {
    "transform": "scale(1.05)",
    "transition": "all .2s ease"
  }
}</code></pre>

      <h3>å®ä¾‹ Dï¼šè‡ªå®šä¹‰å‘½ä»¤é“¾</h3>
      <pre><code>è§¦å‘å™¨: component:dblclick
åŠ¨ä½œ1: EXECUTE_COMMAND
command: play-next-animation
argsJson: {"speed": 1.2}

è§¦å‘å™¨: custom:event
triggerEventName: command:play-next-animation
åŠ¨ä½œ1: SET_COMPONENT_PROPERTY
patchJson:
{
  "text": "å·²æ‰§è¡ŒåŠ¨ç”»å‘½ä»¤",
  "classAdd": "anim-running"
}</code></pre>
    </section>

    <section class="card section">
      <h2>8. è°ƒè¯•ä¸æ’é”™</h2>
      <ul>
        <li><strong>æ²¡ç”Ÿæ•ˆï¼š</strong>å…ˆç¡®è®¤è§„åˆ™ <code>enabled=true</code>ï¼Œä¸”ç»„ä»¶ç¡®å®æŠ•æ”¾åˆ°å½“å‰çª—å£ã€‚</li>
        <li><strong>JSON æŠ¥é”™ï¼š</strong><code>patchJson / headersJson / bodyJson / payloadJson / argsJson</code> å¿…é¡»æ˜¯åˆæ³• JSONã€‚</li>
        <li><strong>å˜é‡ä¸ºç©ºï¼š</strong>ç¡®è®¤äº‹ä»¶é‡Œæœ‰è¯¥å­—æ®µï¼Œæˆ–æ”¹ç”¨ <code>{{eventData.xxx}}</code> è°ƒè¯•ã€‚</li>
        <li><strong>API è¶…æ—¶ï¼š</strong>å¢å¤§ <code>timeoutMs</code>ï¼Œæ£€æŸ¥ URL å’Œè¯ä¹¦ç¯å¢ƒã€‚</li>
        <li><strong>é¿å…æ­»å¾ªç¯ï¼š</strong><code>custom:event</code> é“¾å¼è§¦å‘è¦æ§åˆ¶æ¬¡æ•°å’Œå±‚çº§ã€‚</li>
      </ul>
      <div class="tip warn">å»ºè®®å…ˆåšæœ€å°é“¾è·¯ï¼šä¸€ä¸ªè§¦å‘å™¨ + ä¸€ä¸ªåŠ¨ä½œï¼Œç¡®è®¤åå†å åŠ ã€‚</div>
    </section>

    <section class="card section">
      <h2>9. æ¨èå·¥ç¨‹å®è·µ</h2>
      <ul>
        <li>è§„åˆ™å‘½åæŒ‰â€œè§¦å‘-ç›®æ ‡-åŠ¨ä½œâ€ï¼šä¾‹å¦‚ <code>click-title-setText</code>ã€‚</li>
        <li>ä¸€ä¸ªè§„åˆ™åšä¸€ç±»äº‹ï¼Œå¤æ‚æµç¨‹æ‹†æˆå¤šä¸ª <code>custom:event</code>ã€‚</li>
        <li>API ç»Ÿä¸€å°è£…è¿”å›ç»“æ„ï¼Œæ–¹ä¾¿æ¨¡æ¿ç›´æ¥å–å€¼ã€‚</li>
        <li>æ ·å¼ç±»æ“ä½œä¼˜å…ˆç”¨ <code>classAdd/classRemove</code>ï¼Œé•¿æœŸç»´æŠ¤æ›´ç¨³ã€‚</li>
      </ul>
    </section>
  </div>
</body>

</html>
